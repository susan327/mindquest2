{% extends "base.html" %}
{% block title %}アカウント設定{% endblock %}

{% block content %}
<div class="container" style="max-width: 640px; margin: 0 auto;">
  <h1>👤 アカウント設定（ユーザー登録）</h1>

  {% if user %}
    <p>現在の名前：<strong>{{ user.name }}</strong></p>
    {% if user.email %}
      <p>登録済みメールアドレス：<strong>{{ user.email }}</strong></p>
    {% else %}
      <p>まだメールアドレスは登録されていません。</p>
    {% endif %}
  {% endif %}

  <p>
    ここで <strong>メールアドレスとパスワード</strong> を登録すると、<br>
    他の端末から <a href="{{ url_for('login') }}">ログイン</a> して続きから遊べます。
  </p>

  <hr>

  <!-- メールアドレス・パスワードの登録／変更フォーム -->
  <h2 style="font-size: 18px;">📮 メールアドレス・パスワードの登録／変更</h2>

  <form method="POST" action="{{ url_for('account') }}">
    <div style="margin-bottom: 1em;">
      <label for="email">メールアドレス：</label><br>
      <input
        type="email"
        id="email"
        name="email"
        value="{{ user.email or '' }}"
        required
        style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ccc;"
      >
    </div>

    <div style="margin-bottom: 1em;">
      <label for="password">パスワード：</label><br>
      <input
        type="password"
        id="password"
        name="password"
        placeholder="新しく設定・変更するパスワード"
        required
        style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ccc;"
      >
    </div>

    <div style="margin-bottom: 1em;">
      <label for="password2">パスワード（確認）：</label><br>
      <input
        type="password"
        id="password2"
        name="password2"
        placeholder="確認のため、もう一度入力してください"
        required
        style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ccc;"
      >
    </div>

    <button
      type="submit"
      style="padding: 10px 18px; border-radius: 8px; border: none;
             background: #4CAF50; color: #fff; cursor: pointer;">
      保存する
    </button>
  </form>

  <hr style="margin: 24px 0;">

  <!-- アカウント削除 -->
  <h2 style="font-size: 18px; color:#e74c3c;">⚠ アカウント削除</h2>
  <p>
    このアカウントに紐づく <strong>診断結果・日記</strong> などのデータを<br>
    すべて削除して、このユーザーを消去します。
  </p>
  <p style="color:#e74c3c;"><strong>※ 一度削除すると元に戻せません。</strong></p>

  <form method="POST" action="{{ url_for('account_delete') }}"
        onsubmit="return confirm('本当にこのアカウントを削除しますか？\n（診断結果・日記も消えます）');">
    <button
      type="submit"
      style="padding: 8px 14px; border-radius: 8px; border: none;
             background: #e74c3c; color: #fff; cursor: pointer;">
      アカウントを削除する
    </button>
  </form>

  <hr style="margin: 24px 0;">

  <p>
    メニューに戻る場合は <a href="{{ url_for('menu') }}">こちら</a>。
  </p>
</div>
{% endblock %}
