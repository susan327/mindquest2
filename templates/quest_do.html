{% extends "base.html" %}

{% block title %}ã‚¯ã‚¨ã‚¹ãƒˆ{% endblock %}

{% block content %}
<div class="container" style="max-width: 800px; margin: 0 auto;">

  <h1 style="margin-top:20px; margin-bottom:10px;">{{ quest.title }}</h1>
  <p style="color:#555; font-size:14px; margin-bottom:20px;">
    {{ quest.description }}
  </p>

  <form method="POST">
    {# CSRF ã‚’å…¥ã‚ŒãŸã„ã¨ãã¯ Flask-WTF å°å…¥å¾Œã«ã“ã“ã« {{ csrf_token() }} ã‚’æ›¸ã #}

    {% if steps and steps|length > 0 %}
      {% for step in steps %}
        {% set step_index = loop.index0 %}
        <div style="margin-bottom:18px; padding:14px 16px; border-radius:10px; background:#f8f8ff; border:1px solid #e0e0ff;">

          <div style="font-weight:bold; margin-bottom:8px;">
            STEP {{ loop.index }}ï¼š{{ step.title }}
          </div>

          {# â–¼ é¸æŠå¼ã‚¹ãƒ†ãƒƒãƒ— #}
          {% if step.type == "choice" and step.options %}
            <div style="display:flex; flex-direction:column; gap:6px; font-size:14px;">
              {% for opt in step.options %}
                <label style="cursor:pointer;">
                  <input
                    type="radio"
                    name="step_{{ step_index }}"
                    value="{{ opt }}"
                    style="margin-right:4px;"
                  >
                  {{ opt }}
                </label>
              {% endfor %}
            </div>

          {# â–¼ ãã‚Œä»¥å¤–ï¼ˆtext / grid ã¯å…¨éƒ¨ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›æ‰±ã„ï¼‰ #}
          {% else %}
            <textarea
              name="step_{{ step_index }}"
              rows="3"
              style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; font-size:14px; resize:vertical;"
              placeholder="ã“ã“ã«è‡ªç”±ã«æ›¸ã„ã¦ã¿ã¦ãã ã•ã„"></textarea>
          {% endif %}

        </div>
      {% endfor %}
    {% endif %}

    <!-- â–¼ æŒ¯ã‚Šè¿”ã‚Šã‚³ãƒ¡ãƒ³ãƒˆ -->
    <div style="margin-top:24px; padding:14px 16px; border-radius:10px; background:#f9f9f9; border:1px solid #e0e0e0;">
      <div style="font-weight:bold; margin-bottom:6px;">ğŸ“ æœ€å¾Œã®ã²ã¨ã“ã¨ãƒ¡ãƒ¢</div>
      <p style="font-size:13px; color:#666; margin-bottom:6px;">
        ä»Šæ—¥ã®ã‚¯ã‚¨ã‚¹ãƒˆã‚’é€šã—ã¦æ„Ÿã˜ãŸã“ã¨ãƒ»æ°—ã¥ã„ãŸã“ã¨ã‚’ã€ã²ã¨ã“ã¨ã§ã‚‚ã„ã„ã®ã§æ›¸ã„ã¦ã¿ã¦ãã ã•ã„ã€‚
      </p>
      <textarea
        name="feedback"
        rows="3"
        style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; font-size:14px; resize:vertical;"
        placeholder="ä¾‹ï¼‰æ€ã£ã¦ã„ãŸã‚ˆã‚Šã‚‚ã€‡ã€‡ãŒå¤§äº‹ã ã¨æ°—ã¥ã„ãŸã€ãªã©"></textarea>
    </div>

    <div style="margin-top:20px; text-align:center;">
      <button type="submit" class="btn btn-primary" style="padding:8px 24px; font-size:15px;">
        âœ… ã‚¯ã‚¨ã‚¹ãƒˆå®Œäº†ã—ã¦æŒ¯ã‚Šè¿”ã‚‹
      </button>
    </div>
  </form>

</div>
{% endblock %}
